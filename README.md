![Project version](https://img.shields.io/badge/Project_version-1.0.0-gree)
![Contributors](https://img.shields.io/badge/Contributors-1-blue)

Election Traffic: Polling Station Load Service
===============================================

**Election Traffic: Polling Station Load Service** является клиентским консольным приложением на основе Spring Shell, 
которое разработано как итоговое практическое задание для CROC Spring Java School 2024.

## Краткое описание проекта

Основная цель данного проекта - сбор статистики об избирательных участках и их 
посещаемости во время проведения электоральных процедур. После 
использования приложения и получения предоставляемых им данных,
пользователь сможет как составить комплексную оценку посещаемости выборов,
так и просто решить, в какое время ему завтра лучше идти голосовать,
чтобы провести как можно меньшее количество времени в очереди перед участком.

> Для обеспечения целостности данных и определённой доли исторической достоверности, 
в качестве временного промежутка, на котором проходит
электоральная процедура, выбран период между **15.03.2024** и **17.03.2024**.

## Стэк используемых технологий

- Spring (Java) со **Spring Shell** - основа приложения
- **WebClients** - механизм реализации клиентской логики
- **OpenAPI V3** - спецификация для описания API
- **Git** - система контроля версий

## Работа с проектом

### Необходимое программное обеспечение

Для запуска приложения необходима только Java версии 21 и выше.

Также для работы с приложением желательно 
(но необязательно) использовать системный терминал.

### Порядок запуска

1. Для корректной работы приложения в тестовом (локальном) режиме, необходимо
**сначала** локально (или в docker) запустить [**тестовое API**](https://github.com/watisluv1910/csjs2024-project_test-api) в Development Mode. 
В зависимости от настроек тестового API, может появится необходимость изменить порт, на котором запускается 
клиент или хост, и/или порт, на который он отправляет запросы.
**Такие изменения должны оставаться локальными!**

2. Клонировать репозиторий с проектом:
    ```shell
   git clone https://github.com/watisluv1910/csjs2024-project_service.git
    ```
   
3. Установить [Java](https://www.oracle.com/java/technologies/downloads/) >=21 (если это необходимо).

4. Для запуска Spring Shell и дальнейшей работы в нём необходимо выполнить команду 
запустить следующую команду в **корневой директории** проекта
   <br>Для Unix-подобных систем:
   ```shell
   ./mvnw spring-boot:run
   ``` 
   или для Windows:
    ```cmd
    mvnw.cmd spring-boot:run
    ```

## Команды

### Краткое описание

Так как клиент **Election Traffic: Polling Station Load Service** - консольное приложение,
то для использования его функций необходимы консольные команды. В общем случае они повторяют структуру 
конечных точек [API](src/main/resources/api/reference/openapi.yml), но есть исключения, о которых далее.

> Все консольные команды и их флаги были названы в соответствии с [utility conventions](https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap12.html).

### Иерархия консольных команд

Иерархия консольных команд данного клиента состоит из трёх главных состовляющих:
- Команда `stations` - отвечает за получение **списка с самой необходимой информацией** об избирательных участках:
  - Возвращает список избирательных участков, сгруппированных и отсортированных по региону и по своему номеру внутри региона.
  - Имеет следующие флаги:
    - `--region-codes` или `-r` - даёт возможность определить дополнительное ограничение - один или несколько регионов, 
    в которых будет вестись поиск всех избирательных участков. Коды регионов перечисляются через запятую без пробелов. **Не совместим с** `--station-numbers`.
    - `--station-numbers` или `s` - даёт возможность определить дополнительное ограничение - один или несколько номеров
    избирательных участков, по которым будет вестись поиск по всех регионах. Номера избирательных участков перечисляются через запятую без пробелов. 
    **Не совместим с** `--region-codes`.
  - Также выводит общее количество найденных участков.
- Команда `station_info` - отвечает за получение **полной информации** об участке:
  - Возвращает максимально полную информацию о конкретном участке.
  - Имеет следующие опции:
    - `--id` - наиболее приоритетный критерий отбора участков. Однозначный идентификатор участка в базе данных сервера. Здесь и далее критерии отбора будут перечислены
    в порядке убывания их значимости, соответственно, если критерий `--id` обозначен пользователем, то
    поиск будет производиться именно по нему, даже если заданы ещё критерии.
    - `--border-address` или `-b` - определяет полный граничный адрес участка. Обеспечивает однозначную идентификацию, так как
    система наименования участков и распределения адресов между ними подразумевает, что граничный адрес будет
    соответствовать единственному участку.
    - `--region-code` или `-r` и `--station-number` или `-s` - связка параметров, гарантирующая уникальность найденного по ней избирательного
    участка, так как номер участка уникален внутри региона. Должны использоваться в связке.
    - `--by-date-exclusive` или `-d` - дополнительный параметр, определяющий дату, по которую (включительно) необходимо предоставить
    статистику об определённых избирательных участках.
- Команда `report` - отвечает за **генерацию отчёта** о посещаемости определённых избирательных участков:
  - Имеет следующие опции:
    - `--region-codes` или `-r` - даёт возможность определить дополнительное ограничение - один или несколько регионов,
      в которых будет вестись поиск всех избирательных участков. Коды регионов перечисляются через запятую без пробелов. **Не совместим с** `--station-numbers`.
    - `--station-numbers` или `s` - даёт возможность определить дополнительное ограничение - один или несколько номеров
      избирательных участков, по которым будет вестись поиск по всех регионах. Номера избирательных участков перечисляются через запятую без пробелов.
      **Не совместим с** `--region-codes`.
    - `--by-date-exclusive` или `-d` - дополнительный параметр, определяющий дату, по которую (включительно) необходимо предоставить
      статистику об определённых избирательных участках.
    - `--path` или `-p` - параметр, определяющий путь до файла с отчётом.

> Подробнее про структуры данных, используемых в проекте, можно узнать в [документации](src/main/resources/api/reference/openapi.yml) к API.
